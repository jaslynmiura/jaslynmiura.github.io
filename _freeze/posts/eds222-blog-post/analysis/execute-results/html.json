{
  "hash": "391bee1716fbf0033bc1c2c2c0a52dfa",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Grazing Patterns of Herbivorous Fish in Moʻorea\"\ndescription: \"EDS 222 Final Project: Statistical Analysis of bite rates on coral reefs in Moʻorea\"\ndate: 2025-11-27\ncategories: [MEDS, R]\nformat: html\nimage: images/moorea_reef.jpg\ncitation:\n   url: https://jaslynmiura.github.io/posts/eds222-blog-post/\n# draft: true\n# draft-mode: linked # hides the post on the listing page, the url exists just hides it from main website.\n# bibliography: references.bib\n---\n\n# Background\n\nDue to changing climate conditions, macroalgae coverage can impact the transitional phases in coral colonization. Since coral reefs play such an important role in ecosystem services understanding coral reef dynamics is important. An aspect of this is understanding how macroalgae within the systems are being controlled. The herbivorous fishes Chlorurus sordidus, commonly known as parrot fish, and Ctenochaetus striatus, commonly known as striated surgeonfish are reef fish that feed on the algae directly impacting coral reefs.\n\nThis observation data in was collected from the coral reefs of Moʻorea, French Polynesia at research stations LTER 1 and Resilience 2. Focal fish species were identified by a SCUBA diver, an estimated fish length (cm), the depth at the start and end of the observation period, substrate types, and the number of bites taken within 5 minutes was recorded. The data was collected several days in July and August of 2010 between the times of 10:00 and 16:00, an identified period of time which corresponds to peak feeding rates for may herbivorous fishes (Adam, 2019).\n\nUsing this data we want to understand, how herbivore grazing bite counts are influenced by fish size, species, depth, and substrate.\n\n## Data Collection and Cleaning\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nlibrary(tidyverse)\nlibrary(dplyr)\nlibrary(janitor)\nlibrary(MASS)\nlibrary(knitr)\nlibrary(kableExtra)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Load in the data.\ndata1 <- read_csv(here::here(\"posts\",\n                             \"eds222-blog-post\",\n                             \"data\",\n                             \"MCR_LTER_HerbBite_Focal_Herb_Bite_Rates_2010_20120521.csv\")) %>% \n  clean_names() %>%\n  dplyr::select(-c(time_period, depth_cat))\n\ndata2 <- read_csv(here::here(\"posts\", \n                             \"eds222-blog-post\",\n                             \"data\", \n                             \"MCR_LTER_HerbBite_Addit_Bite_Rate_Data_2010_20120521.csv\")) %>% \n  clean_names()\n\n# Stacking the datasets and dropping unnecessary columns.\nbite_data <- rbind(data1, data2) %>% \n  dplyr::select(-c(\"observer\", \"time_beg\", \"time_end\", \"stage\", \"notes\")) %>% \n  drop_na()\n\n# Creating a mean_depth column.\nbite_data$mean_depth <- (bite_data$depth_beg + bite_data$dept_end) / 2\n\n# Dropping the depth range columns.\nbite_data <- bite_data %>% \n  dplyr::select(-c(\"depth_beg\", \"dept_end\"))\n\n# Of the substrate type create a column of the dominant substrate.\nbite_data$dominant_substrate <- apply(\n  bite_data[, c(\"bare\", \"rubble\", \"cca\", \"sand\", \"other\")],\n  1,\n  function(x) names(x)[which.max(x)])\n\n# Drop individual substrate columns make species and substrates factors.\nbite_data_clean <- bite_data %>% \n  dplyr::select(-c(\"bare\", \"rubble\", \"cca\", \"sand\", \"other\")) %>% \n  mutate(species = factor(species),\n         dominant_substrate = factor(dominant_substrate))\n```\n:::\n\n\nThe data source provides two datasets that hold data from observations from different dates and locations. After stacking the dataframes, columns that were not required for the analysis were dropped. Some cleaning of our variables was conducted. A `mean_depth` column was created, which is the average depth during each observation. This was created by taking the average depth between the recorded depth at the start and end of the observation. A `dominant_substrate` column was also created, which represents the substrate that was bitten the most of all the possible substrates. This was done by detecting which substrate had the highest number of bites, for each observed fish.\n\n## Data Exploration\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot of size vs. total bites, by species.\nggplot(data = bite_data_clean, aes(x = size_cm, y = total_bites, color = species)) +\n  geom_jitter() +\n  labs(x = \"Fish Length (cm)\",\n       y = \"Total number of bites\",\n       color = \"Species\") +\n  scale_color_manual(values = c(\"dodgerblue\", \"violet\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Figure 1: Total number of bites as a result of Fish Length (cm), by species, across 164 observed fish.](analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot of mean depth vs. total bites, by species\nggplot(data = bite_data_clean, aes(x = mean_depth, y = total_bites, color = species)) +\n  geom_jitter() +\n  labs(x = \"Mean depth (ft)\",\n       y = \"Total number of bites\",\n       color = \"Species\") +\n  scale_color_manual(values = c(\"dodgerblue\", \"violet\")) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Figure 2: Total number of bites as a result of Mean Depth (ft), by species, across 164 observed fish.](analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Total bite count distribution\nggplot(data = bite_data_clean, aes(x = total_bites)) +\n  geom_histogram(binwidth = 10,\n                 fill = \"black\") +\n  labs(x = \"Total number of bites\",\n       y = \"Count\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Figure 3: Distribution of the Total number of bites.](analysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nThe data is not normally distributed. The total number of bites is right skewed.\n\n# Question\n\n**Research Question:** How is the herbivore grazing bite counts related to fish size, species, depth, and substrate?\n\n### Create a DAG\n\n![Directed Acyclic Graph, representing potential relationships and causal relationships between variables](images/moorea_DAG.png)\n\n**Null Hypothesis:** Either size, species, depth, or substrate have no effect on bite count.\n\n**Alternative Hypothesis:** A predictor/predictors have an effect on bite count.\n\n**Hypothesis in Statistical Notation:**\n\n$$H_0: \\beta_1 = 0$$\n$$H_A: \\beta_1 \\neq 0$$\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Find the mean and variance.\nvar_total_bites <- var(bite_data_clean$total_bites)\nmean_total_bites <- mean(bite_data_clean$total_bites)\n\n# Check that variance is greater than the mean.\nif (var_total_bites > mean_total_bites) {\n  print(\"After testing, the variance of the `total_bites` is greater than the mean of `total_bites`.\")\n  print(paste(\"Variance:\", var_total_bites))\n  print(paste(\"Mean:\", mean_total_bites))\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"After testing, the variance of the `total_bites` is greater than the mean of `total_bites`.\"\n[1] \"Variance: 4127.29773305402\"\n[1] \"Mean: 119.786585365854\"\n```\n\n\n:::\n:::\n\n\n**What model?**: Since we are dealing with count data, `total_bites`, our model options are Poisson Regression or Negative Binomial Regression. Since the Poisson distribution assumes that the mean and variance are equal, which is an assumption that our data does not meet. The mean of `total_bites` is 4127.2977331 and the variance of `total_bites` is 4127.2977331 . Since the variance is greater than the mean, the distribution of our count data, `total_bites` exhibits overdispersion; which is a factor that the Negative Binomial Regression model accounts for.\n\n## Negative Binomial Regression model notation:\n\n$$\n\\begin{aligned}\n\\text{BiteCount} &\\sim Negative Binomial(\\mu, \\theta)\n\\end{aligned}\n$$\n$$\n\\begin{aligned}\nlog(\\mu) &= \\beta_0 + \\beta_1 \\text{Size} + \\beta_2 \\text{Species} + \\beta_3 \\text{Depth} + \\beta_4 \\text{Substrate} \\\\\n\\end{aligned}\n$$\n\n# Fit model to simulated data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Set seed for reproducibility purposes.\nset.seed(123)\n\n# Select coefficient values.\nbeta0 <- 1\nbeta1 <- -0.3\ntheta <- 1.5\n\n# Generate random x values.\nx1 <- rnorm(10000, mean = 0, sd = 2)\n\n# Find mu in link space.\nlog_mu <- beta0 + beta1 * x1\n\n# Transform the log_mu to response space.\nmu <- exp(log_mu)\n\n# Generate random y values.\ny <- rnbinom(n = 10000, size = theta, mu = mu)\n\n# Create a tibble of x1 and y.\nsim_data <- tibble(x1, y)\n\n# Fite a negative binomial model to the simulated data.\nnegbi <- glm.nb(y ~ x1, data = sim_data)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Get the summary statistics of the negative binomial model.\nsim_model_table <- broom::tidy(negbi) %>% \n  kbl(caption = \"Coeffieicent Estimates of the Full Additive Model\") %>%\n  kable_paper(full_width=TRUE)\nsim_model_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Coeffieicent Estimates of the Full Additive Model</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> 1.0049830 </td>\n   <td style=\"text-align:right;\"> 0.0104884 </td>\n   <td style=\"text-align:right;\"> 95.81852 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> x1 </td>\n   <td style=\"text-align:right;\"> -0.2948176 </td>\n   <td style=\"text-align:right;\"> 0.0053281 </td>\n   <td style=\"text-align:right;\"> -55.33253 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Fit model to real data\n\nWe'll use and additive Negative Binomial Regression model. Our predictor variables are `size_cm`, `species`, `mean_depth`, `dominant_substrate`, and an offset of `seconds_observed`.\n\nSince the time observed varied between 5 minutes, we want to use an offset within our model since larger or smaller data could be collected based on the time spent measuring total bite counts.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfull_model <- glm.nb(total_bites ~ size_cm + species + mean_depth + dominant_substrate + offset(log(seconds_observed)), data = bite_data_clean)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfull_model_table <- broom::tidy(full_model) %>% \n  kbl(caption = \"Coeffieicent Estimates of the Full Additive Model\") %>%\n  kable_paper(full_width=TRUE)\nfull_model_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Coeffieicent Estimates of the Full Additive Model</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.7224262 </td>\n   <td style=\"text-align:right;\"> 0.4229417 </td>\n   <td style=\"text-align:right;\"> -1.7080987 </td>\n   <td style=\"text-align:right;\"> 0.0876180 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> size_cm </td>\n   <td style=\"text-align:right;\"> -0.0519902 </td>\n   <td style=\"text-align:right;\"> 0.0215223 </td>\n   <td style=\"text-align:right;\"> -2.4156482 </td>\n   <td style=\"text-align:right;\"> 0.0157072 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> speciesCtenochaetus striatus </td>\n   <td style=\"text-align:right;\"> 0.0947912 </td>\n   <td style=\"text-align:right;\"> 0.1189715 </td>\n   <td style=\"text-align:right;\"> 0.7967551 </td>\n   <td style=\"text-align:right;\"> 0.4255933 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean_depth </td>\n   <td style=\"text-align:right;\"> 0.0152081 </td>\n   <td style=\"text-align:right;\"> 0.0044205 </td>\n   <td style=\"text-align:right;\"> 3.4403547 </td>\n   <td style=\"text-align:right;\"> 0.0005810 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dominant_substraterubble </td>\n   <td style=\"text-align:right;\"> 0.0594797 </td>\n   <td style=\"text-align:right;\"> 0.1318579 </td>\n   <td style=\"text-align:right;\"> 0.4510897 </td>\n   <td style=\"text-align:right;\"> 0.6519249 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Coefficient Interpretations:\n\n$\\beta_1$ representing the size effect is a significant as for every centimeter increase in fish length, the expected bite count decreases by about 0.05199, when holding other predictor variables constant. $\\beta_2$ representing the species effect, with parrot fish being our reference level, is not significant. Which indicates that the expected bite count between the two species are statistically the same, when holding other predictor variables constant. $\\beta_3$ representing depth effect is very significant predictor as our p-value is extremely low, meaning that the probability of the observed results occurring by random change is 0.058%. Therefore, for every meter increase in depth, expected bite count increases by about 0.015208. $\\beta_4$ representing the substrate effect, with bare being the reference level, is not significant. This means that substrate does not statistically influence expected bite counts.\n\nIn summary, bite count decreases when fish length increases, suggesting that larger fish take fewer bites, which can be explained by the idea of larger fish taking less bites, due to taking bigger bites. Bite counts also significantly increase as depth increases. This can indicate more food availability at different depth levels.\n\n# Generating Predictions\n\nNext I'll generate expected bite count predictions. The predictions will be generated varying the fish lengths (cm), `size_cm`, and holding all other variables constant.\n\nThe expected bite count predictions were generated in response space, while the confidence interval for the expected bite count predictions were generated in link space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create grid for generated predictions.\nbite_pred_grid <- expand_grid(\n  size_cm = seq(12, 25, by = 0.5),\n  mean_depth = mean(bite_data_clean$mean_depth),\n  species = levels(bite_data_clean$species),\n  seconds_observed = mean(bite_data_clean$seconds_observed)) %>%\n  mutate(\n    species = factor(species, levels = levels(bite_data_clean$species)),\n    dominant_substrate = factor(\"bare\", levels = levels(bite_data_clean$dominant_substrate)))\n\n# Generate predictions.\nbite_pred_grid$predicted_bites <- predict(full_model,\n                                          newdata = bite_pred_grid,\n                                          type = \"response\")\n\n# Generate a standard error for predictions.\nbite_pred_se <- predict(object = full_model,\n                        newdata = bite_pred_grid,\n                        type = \"link\", \n                        se.fit = TRUE)\n\n# Go from link space to response space\nlinkinv <- family(full_model)$linkinv\nbite_pred_grid <- bite_pred_grid %>% \n  mutate(\n    \n    # get log(mu)\n    log_mu = bite_pred_se$fit,\n    \n    # 95% CI in link space\n    log_mu_se = bite_pred_se$se.fit,\n    log_mu_lwr = qnorm(0.025, mean = log_mu, sd = log_mu_se),\n    log_mu_upr = qnorm(0.975, mean = log_mu, sd = log_mu_se),\n    \n    # undo the link function using linkinv\n    mu = linkinv(log_mu), \n    mu_lwr = linkinv(log_mu_lwr),\n    mu_upr = linkinv(log_mu_upr)\n  )\n```\n:::\n\n\nWe'll then plot the expected bite count predictions along with the observed values to see how well our expected predictions from the model, fit the data.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot the observed variables and \nggplot(bite_pred_grid, aes(size_cm, predicted_bites, color = species)) +\n  geom_ribbon(aes(ymin = mu_lwr, ymax = mu_upr), alpha = 0.2) +\n  geom_line() +\n  geom_jitter(data = bite_data_clean, aes(x= size_cm, y = total_bites)) + \n  scale_color_manual(values = c(\"dodgerblue\", \"violet\")) +\n  facet_wrap(~species, scales = \"free_x\") +\n  labs(x = \"Length of Fish (cm)\",\n       y = \"Total bite counts\",\n       color = \"Species\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Figure 4: Observed data fit to the expected bite count predictions.](analysis_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Making Predictions, with interactions and varying mean depth.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfinal_model <- glm.nb(total_bites ~ size_cm + species*mean_depth + dominant_substrate + offset(log(seconds_observed)), data = bite_data_clean)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nfinal_model_table <- broom::tidy(final_model) %>% \n  kbl(caption = \"Coeffieicent Estimates of the Full Additive Interactive Model\") %>%\n  kable_paper(full_width=TRUE)\nfinal_model_table\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-paper\" style='font-family: \"Arial Narrow\", arial, helvetica, sans-serif; margin-left: auto; margin-right: auto;'>\n<caption>Coeffieicent Estimates of the Full Additive Interactive Model</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> term </th>\n   <th style=\"text-align:right;\"> estimate </th>\n   <th style=\"text-align:right;\"> std.error </th>\n   <th style=\"text-align:right;\"> statistic </th>\n   <th style=\"text-align:right;\"> p.value </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> (Intercept) </td>\n   <td style=\"text-align:right;\"> -0.1330416 </td>\n   <td style=\"text-align:right;\"> 0.4784270 </td>\n   <td style=\"text-align:right;\"> -0.2780812 </td>\n   <td style=\"text-align:right;\"> 0.7809500 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> size_cm </td>\n   <td style=\"text-align:right;\"> -0.0647547 </td>\n   <td style=\"text-align:right;\"> 0.0215775 </td>\n   <td style=\"text-align:right;\"> -3.0010257 </td>\n   <td style=\"text-align:right;\"> 0.0026907 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> speciesCtenochaetus striatus </td>\n   <td style=\"text-align:right;\"> -0.6869812 </td>\n   <td style=\"text-align:right;\"> 0.3583561 </td>\n   <td style=\"text-align:right;\"> -1.9170349 </td>\n   <td style=\"text-align:right;\"> 0.0552335 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> mean_depth </td>\n   <td style=\"text-align:right;\"> 0.0061290 </td>\n   <td style=\"text-align:right;\"> 0.0060036 </td>\n   <td style=\"text-align:right;\"> 1.0208837 </td>\n   <td style=\"text-align:right;\"> 0.3073096 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> dominant_substraterubble </td>\n   <td style=\"text-align:right;\"> 0.0546794 </td>\n   <td style=\"text-align:right;\"> 0.1300324 </td>\n   <td style=\"text-align:right;\"> 0.4205060 </td>\n   <td style=\"text-align:right;\"> 0.6741159 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> speciesCtenochaetus striatus:mean_depth </td>\n   <td style=\"text-align:right;\"> 0.0183200 </td>\n   <td style=\"text-align:right;\"> 0.0080984 </td>\n   <td style=\"text-align:right;\"> 2.2621793 </td>\n   <td style=\"text-align:right;\"> 0.0236863 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n#### Coefficient Interpretations:\n\n$\\beta_1$ representing the size effect is again significant, where for every centimeter increase in fish length, the expected bite count decreases by 0.0648. $\\beta_2$ representing the species effect. This coefficient specifically is the difference in expected bite counts between the species, when the depth is 0. Therefore, when depth is 0, we'd expect the bite count for parrot fish to be about 0.687 counts lower than striated surgeonfish. $\\beta_3$ representing the depth effect on striated surgeonfish, is not significant. Meaning that depth does not affect the expected bite count of striated surgeonfish. $\\beta_4$ representing the dominant substrate effect is again not significant. Therefore, when holding all other variables constant, substrate does not affect the expected bite count. $\\beta_5$ representing the interaction between species and depth effect, is also the indicator of depth effect on parrot fish in relation to striated surgeonfish. Using the sum of estimate of $\\beta_3$ and $\\beta_5$ we can calculate the slope of depth's effect on parrot fish expected bite counts. This means that for every meter increase in depth, expected bite counts for the parrot fish will increase by 0.02445.\n\nIn summary, this new additive interaction Negative Binomial Regression model indicates that again larger fish take less bites. Within this new model an important effect is that at deeper depths, the bite counts of parrot fish increase. However, the model does not indicate a similar significant pattern for striated surgeonfish. Therefore, the model reveals different behaviors and patterns within species related to herbivory grazing upon coral reefs.\n\n# Generate Predictions\n\nFinally, we'll generate expected bite count predictions from the new additive interactive Negative Binomial Regression model. The predictions will be generated varying the depth, `mean_depth`, and holding all other variables constant.\n\nThe expected bite count predictions will be generated in response space, while the confidence interval for the expected bite count predictions will be generated in link space.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find the mean size, by species.\nspecies_means <- bite_data_clean %>% \n  group_by(species) %>%\n  summarise(\n    mean_size = mean(size_cm, na.rm = TRUE))\n\n# Create grid for generated predictions.\nbite_pred_grid2 <- expand_grid(\n  mean_depth = seq(25, 61, by = 0.5),\n  species = levels(bite_data_clean$species),\n  seconds_observed = mean(bite_data_clean$seconds_observed)) %>%\n  left_join(species_means, by = \"species\") %>%\n  mutate(\n    size_cm = mean_size,\n    dominant_substrate = factor(\"bare\", levels = levels(bite_data_clean$dominant_substrate)),\n    species = factor(species, levels = levels(bite_data_clean$species)))\n\n# Generate predictions.\nbite_pred_grid2$predicted_bites <- predict(final_model,\n                                          newdata = bite_pred_grid2,\n                                          type = \"response\")\n\n# Generate a standard error for predictions.\nbite_pred_se2 <- predict(object = final_model,\n                        newdata = bite_pred_grid2,\n                        type = \"link\", \n                        se.fit = TRUE)\n\n# Go from link space to response space\nlinkinv <- family(final_model)$linkinv\nbite_pred_grid2 <- bite_pred_grid2 %>% \n  mutate(\n    # get log(mu)\n    log_mu = bite_pred_se2$fit,\n    # 95% CI in link space\n    log_mu_se = bite_pred_se2$se.fit,\n    \n    log_mu_lwr = qnorm(0.025, mean = log_mu, sd = log_mu_se),\n    log_mu_upr = qnorm(0.975, mean = log_mu, sd = log_mu_se),\n    \n    # undo the link function using linkinv\n    mu = linkinv(log_mu), \n    mu_lwr = linkinv(log_mu_lwr),\n    mu_upr = linkinv(log_mu_upr)\n  )\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Plot the observed variables and \nggplot(bite_pred_grid2, aes(mean_depth, predicted_bites, color = species)) +\n  geom_ribbon(aes(ymin = mu_lwr, ymax = mu_upr), alpha = 0.2) +\n  geom_line() +\n  geom_jitter(data = bite_data_clean, aes(x= mean_depth, y = total_bites)) + \n  scale_color_manual(values = c(\"dodgerblue\", \"violet\")) +\n  facet_wrap(~species, scales = \"free_x\") +\n  labs(x = \"Depth (m)\",\n       y = \"Total bite counts\",\n       color = \"Species\") + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Figure 5: Observed data fit to the expected bite count predictions. Predictions generated from varying depth and keeping all other variables constant.](analysis_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n### Conclusions:\n\nFrom this analysis we found that size has a significant effect on total bite counts, where larger fish take less bites. Another significant finding was that there was a significant effect of the interaction of species and depth. Which indicated that the there are different feeding behaviors of the species at different depths. After collecting these results further research can be done to understand the behaviors of the species at different depths, which would include collecting other variables that could have an effect on bite counts. Such as different environmental factors such as temperature, pH levels, presence of other species, etc. This analysis could provide a baseline for stakeholders when it comes to conservation decision making. For example, by using this analysis and with further research size limits can be created or updated to protect the size range of species that feed the most on the coral reefs.\n\n#### References:\n\nHolbrook, S., Schmitt, R., Adam, T. et al. Coral Reef Resilience, Tipping Points and the Strength of Herbivory. Sci Rep 6, 35817 (2016). [https://doi.org/10.1038/srep35817](https://doi.org/10.1038/srep35817)\n\nMoorea Coral Reef LTER and T. Adam. 2019. MCR LTER: Coral Reef Resilience: Herbivore Bite Rates on the North Shore Forereef July-August 2010 ver 2. Environmental Data Initiative. [https://doi.org/10.6073/pasta/5a6798c5694d5a58362ab42e584b7b71](https://doi.org/10.6073/pasta/5a6798c5694d5a58362ab42e584b7b71) (Accessed 2025-12-04).\n\nMoorea Coral Reef LTER (2025). Common Corals of Moorea [jpg]. Moorea Coral Reef LTER member of the NSF Long Term Ecological Research Network. [https://mcr.lternet.edu/about/media](https://mcr.lternet.edu/about/media)\n",
    "supporting": [
      "analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}